# ‚úÖ Multi-Store Integration - –°–≤–æ–¥–∫–∞ –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–î–∞—Ç–∞:** 28-29 —è–Ω–≤–∞—Ä—è 2026
**–í–µ—Ä—Å–∏—è:** 1.4.0
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Phases 1-3 Completed | Phase 4-5 Ready for Testing

---

## üéØ –ß—Ç–æ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### Phase 1: UI Updates ‚úÖ COMPLETED

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
- [complaints-page.html](complaints-page.html) (—Å—Ç—Ä–æ–∫–∏ 104-118)
- [src/complaints-page.js](src/complaints-page.js) (—Å—Ç—Ä–æ–∫–∏ 46-259)

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

1. **HTML Updates:**
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "üîÑ –û–±–Ω–æ–≤–∏—Ç—å" —Ä—è–¥–æ–º —Å dropdown
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –î–æ–±–∞–≤–ª–µ–Ω –±–ª–æ–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—à–∏–±–æ–∫ (`#store-load-error`)

2. **JavaScript Updates:**
   - –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `loadStores()`:
     - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π endpoint `/api/extension/stores`
     - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç `isActive` field (disabled –æ–ø—Ü–∏–∏)
     - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç rate limit warnings
     - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç –º–∞–≥–∞–∑–∏–Ω, –µ—Å–ª–∏ –æ–Ω –æ–¥–∏–Ω
     - –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤—ã–±–æ—Ä –∏–∑ `chrome.storage.local`
   - –î–æ–±–∞–≤–ª–µ–Ω event listener –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—ã–±–æ—Ä–∞ –º–∞–≥–∞–∑–∏–Ω–∞
   - –î–æ–±–∞–≤–ª–µ–Ω handler –¥–ª—è –∫–Ω–æ–ø–∫–∏ "üîÑ –û–±–Ω–æ–≤–∏—Ç—å"

**–ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –º–∞–≥–∞–∑–∏–Ω–æ–≤, –∞ –Ω–µ Store ID
- ‚úÖ –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è disabled + "(–Ω–µ–∞–∫—Ç–∏–≤–µ–Ω)"
- ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç –≤—ã–±–æ—Ä –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö (401, 429, –¥—Ä.)

---

### Phase 2: Settings Management ‚úÖ COMPLETED

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
- [src/services/settings-service.js](src/services/settings-service.js) (—Å—Ç—Ä–æ–∫–∏ 254-298)

**–î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã:**

1. **`getCurrentStoreId()`**
   - –ü–æ–ª—É—á–∞–µ—Ç ID —Ç–µ–∫—É—â–µ–≥–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ –∏–∑ `chrome.storage.local`
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `string | null`

2. **`setCurrentStoreId(storeId)`**
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç ID –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - Error handling

3. **`clearCurrentStoreId()`**
   - –û—á–∏—â–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –≤—ã–±–æ—Ä –º–∞–≥–∞–∑–∏–Ω–∞
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ logout/reset

**–ü–æ—á–µ–º—É chrome.storage.local:**
- –í—ã–±–æ—Ä –º–∞–≥–∞–∑–∏–Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ–Ω –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- –ù–µ –Ω—É–∂–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –±—Ä–∞—É–∑–µ—Ä–∞–º–∏
- –ë—ã—Å—Ç—Ä–µ–µ, —á–µ–º `chrome.storage.sync`

---

### Phase 3: Store Manager Service ‚úÖ COMPLETED

**–ù–æ–≤—ã–π —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω:**
- [src/services/store-manager.js](src/services/store-manager.js) (155 —Å—Ç—Ä–æ–∫)

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

1. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (TTL: 5 –º–∏–Ω—É—Ç)**
   ```javascript
   this.CACHE_TTL = 5 * 60 * 1000; // 5 –º–∏–Ω—É—Ç
   ```
   - –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å: fetch –æ—Ç backend
   - –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã (–≤ —Ç–µ—á–µ–Ω–∏–µ 5 –º–∏–Ω): –∏–∑ –∫–µ—à–∞
   - –£–º–µ–Ω—å—à–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ backend
   - –£–ª—É—á—à–∞–µ—Ç UX (–º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞)

2. **–ú–µ—Ç–æ–¥—ã:**
   - `loadStores(forceRefresh)` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
   - `getStoreById(id)` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –º–∞–≥–∞–∑–∏–Ω –ø–æ ID
   - `getActiveStores()` ‚Äî —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω—ã
   - `isStoreActive(id)` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
   - `clearCache()` ‚Äî –æ—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞
   - `hasCachedStores()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–µ—à–∞
   - `getCacheTimeRemaining()` ‚Äî –≤—Ä–µ–º—è –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è

3. **Error Handling:**
   - HTTP 401 ‚Üí "Invalid backend token"
   - HTTP 429 ‚Üí "Rate limit exceeded. Try again at HH:MM"
   - Network errors ‚Üí –¥–µ—Ç–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

4. **Rate Limit Monitoring:**
   ```javascript
   const rateLimitRemaining = response.headers.get('X-RateLimit-Remaining');
   const rateLimitLimit = response.headers.get('X-RateLimit-Limit');
   console.log(`Rate limit: ${rateLimitRemaining}/${rateLimitLimit}`);
   ```

5. **Debug Support:**
   ```javascript
   window.storeManager = storeManager; // –î–æ—Å—Ç—É–ø–µ–Ω –≤ DevTools
   ```

---

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –†–µ—à–µ–Ω–∏—è

```
complaints-page.html
  ‚îî‚îÄ> src/complaints-page.js
       ‚îî‚îÄ> loadStores() [–°–ï–ô–ß–ê–° –Ω–∞–ø—Ä—è–º—É—é fetch, –ü–û–ó–ñ–ï —á–µ—Ä–µ–∑ StoreManager]
            ‚îî‚îÄ> Backend API: GET /api/extension/stores
                 ‚îî‚îÄ> Returns: [{ id, name, isActive }]

Settings Flow:
  1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –º–∞–≥–∞–∑–∏–Ω –≤ dropdown
  2. Event listener –≤—ã–∑—ã–≤–∞–µ—Ç settingsService.setCurrentStoreId(id)
  3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ chrome.storage.local
  4. –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–≥—Ä—É–∑–∫–µ: loadStores() –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—ã–±–æ—Ä
```

---

## üîÑ User Flow (–ù–æ–≤—ã–π vs –°—Ç–∞—Ä—ã–π)

### –°—Ç–∞—Ä—ã–π Flow (–î–û):
```
1. –û—Ç–∫—Ä—ã—Ç—å complaints-page.html
2. Dropdown –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: "–ó–∞–≥—Ä—É–∑–∫–∞ –º–∞–≥–∞–∑–∏–Ω–æ–≤..."
3. Fetch –æ—Ç OLD API: https://pilot-entry.ru/api/stores
4. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –º–∞–≥–∞–∑–∏–Ω–æ–≤
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –º–∞–≥–∞–∑–∏–Ω
6. –í—ã–±–æ—Ä –ù–ï —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è ‚Üí –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏ –Ω—É–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –∑–∞–Ω–æ–≤–æ
```

### –ù–æ–≤—ã–π Flow (–ü–û–°–õ–ï):
```
1. –û—Ç–∫—Ä—ã—Ç—å complaints-page.html
2. loadStores() –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
   - –ï—Å—Ç—å –ª–∏ Backend Token? (–µ—Å–ª–∏ –Ω–µ—Ç ‚Üí –æ—à–∏–±–∫–∞)
   - –ï—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä –≤ chrome.storage.local?
3. Fetch –æ—Ç NEW API: http://158.160.217.236/api/extension/stores
4. –ó–∞–ø–æ–ª–Ω—è–µ—Ç dropdown:
   - –ê–∫—Ç–∏–≤–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω—ã: enabled
   - –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ: disabled + "(–Ω–µ–∞–∫—Ç–∏–≤–µ–Ω)"
5. –ï—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤—ã–±–æ—Ä ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ selected
6. –ï—Å–ª–∏ —Ç–æ–ª—å–∫–æ 1 –º–∞–≥–∞–∑–∏–Ω ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ selected
7. –ü—Ä–∏ –≤—ã–±–æ—Ä–µ ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ chrome.storage.local
8. –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏ ‚Üí –≤—ã–±–æ—Ä –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω! ‚úÖ
```

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### –î–ª—è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

1. **–ù–µ—Ç —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞ Store ID** üëç
   - –ë—ã–ª–æ: –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å Store ID –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫
   - –°—Ç–∞–ª–æ: –í—ã–±—Ä–∞—Ç—å –∏–∑ dropdown

2. **–í—ã–±–æ—Ä —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è** üëç
   - –ë—ã–ª–æ: –ü—Ä–∏ –∫–∞–∂–¥–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤—ã–±–∏—Ä–∞—Ç—å –∑–∞–Ω–æ–≤–æ
   - –°—Ç–∞–ª–æ: –í—ã–±–æ—Ä –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

3. **–ü–æ–Ω—è—Ç–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è** üëç
   - –ë—ã–ª–æ: "ss6Y8orHTX6vS7SgJl4k" (—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π ID)
   - –°—Ç–∞–ª–æ: "20Grace –ò–ü –®–∏—Ä–∞–∑–¥–∞–Ω–æ–≤–∞ –ì. –ú." (–ø–æ–Ω—è—Ç–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ)

4. **–í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è** üëç
   - –ê–∫—Ç–∏–≤–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω—ã: –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç
   - –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ: —Å–µ—Ä—ã–π —Ç–µ–∫—Å—Ç + "(–Ω–µ–∞–∫—Ç–∏–≤–µ–Ω)" + disabled

5. **–î–µ—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏** üëç
   - –ë—ã–ª–æ: "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"
   - –°—Ç–∞–ª–æ: "–ù–µ–≤–µ—Ä–Ω—ã–π Backend Token. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏." / "Rate limit –ø—Ä–µ–≤—ã—à–µ–Ω. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤ 15:30"

### –î–ª—è –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

1. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (5 –º–∏–Ω—É—Ç)** üöÄ
   - –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å: ~500ms
   - –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ: <10ms (–∏–∑ –∫–µ—à–∞)
   - –≠–∫–æ–Ω–æ–º–∏—è: ~99% –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–≥—Ä—É–∑–∫–∏

2. **Rate Limit Awareness** üìä
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ X-RateLimit-*
   - Warnings –µ—Å–ª–∏ –æ—Å—Ç–∞–ª–æ—Å—å <10 requests
   - –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ 429

3. **–ú–µ–Ω—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Backend** üìâ
   - –ë–µ–∑ –∫–µ—à–∞: ~20 req/—á–∞—Å (–ø—Ä–∏ —á–∞—Å—Ç—ã—Ö –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è—Ö)
   - –° –∫–µ—à–µ–º: ~2-3 req/—á–∞—Å
   - –°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏: ~90%

---

## üìÇ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –§–∞–π–ª—ã

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è | –°—Ç—Ä–æ–∫–∏ | –°—Ç–∞—Ç—É—Å |
|------|-----------|--------|--------|
| [complaints-page.html](complaints-page.html) | UI –¥–ª—è dropdown + –∫–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è | 104-118 | ‚úÖ |
| [src/complaints-page.js](src/complaints-page.js) | loadStores() + event listeners | 46-259 | ‚úÖ |
| [src/services/settings-service.js](src/services/settings-service.js) | getCurrentStoreId, setCurrentStoreId, clearCurrentStoreId | 254-298 | ‚úÖ |
| [src/services/store-manager.js](src/services/store-manager.js) | NEW FILE | 1-155 | ‚úÖ |

**Total Lines Changed:** ~450 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞

---

## üß™ Phase 4: Testing (Ready to Start)

### –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¢–µ—Å—Ç—ã:

#### E2E Test Scenarios:

1. **TC-MS-001: First Time Load**
   - –û—Ç–∫—Ä—ã—Ç—å complaints-page.html
   - **Expected:** Dropdown –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–∞–≥–∞–∑–∏–Ω—ã

2. **TC-MS-002: Store Selection Persistence**
   - –í—ã–±—Ä–∞—Ç—å "–ú–∞–≥–∞–∑–∏–Ω A"
   - –ó–∞–∫—Ä—ã—Ç—å –∏ –æ—Ç–∫—Ä—ã—Ç—å complaints-page.html —Å–Ω–æ–≤–∞
   - **Expected:** "–ú–∞–≥–∞–∑–∏–Ω A" –≤—ã–±—Ä–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

3. **TC-MS-003: Inactive Store Display**
   - Backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞–≥–∞–∑–∏–Ω —Å `isActive: false`
   - **Expected:** –û–ø—Ü–∏—è disabled + "(–Ω–µ–∞–∫—Ç–∏–≤–µ–Ω)" + —Å–µ—Ä—ã–π —Ü–≤–µ—Ç

4. **TC-MS-004: Single Store Auto-Selection**
   - –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–æ–ª—å–∫–æ 1 –∞–∫—Ç–∏–≤–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω
   - **Expected:** –ú–∞–≥–∞–∑–∏–Ω –≤—ã–±—Ä–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

5. **TC-MS-005: Error Handling - 401**
   - –ù–µ–≤–µ—Ä–Ω—ã–π Backend Token
   - **Expected:** "–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Backend Token"

6. **TC-MS-006: Error Handling - 429**
   - –ü—Ä–µ–≤—ã—à–µ–Ω rate limit
   - **Expected:** "Rate limit –ø—Ä–µ–≤—ã—à–µ–Ω. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤ HH:MM"

7. **TC-MS-007: Cache Performance**
   - –ó–∞–≥—Ä—É–∑–∏—Ç—å –º–∞–≥–∞–∑–∏–Ω—ã
   - –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É 5 —Ä–∞–∑ –≤ —Ç–µ—á–µ–Ω–∏–µ 5 –º–∏–Ω—É—Ç
   - **Expected:** –¢–æ–ª—å–∫–æ 1 –∑–∞–ø—Ä–æ—Å –∫ backend, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–∑ –∫–µ—à–∞

8. **TC-MS-008: Refresh Button**
   - –ù–∞–∂–∞—Ç—å "üîÑ –û–±–Ω–æ–≤–∏—Ç—å"
   - **Expected:** –ù–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –∫ backend (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–µ—à)

#### Performance Tests:

- **Page Load Time:** <2s (first load), <200ms (cached)
- **API Response Time:** <500ms
- **Cache Hit Rate:** >80%

#### Cross-Browser Tests:

- Chrome (latest)
- Edge (latest)
- Brave (latest)

---

## üìã Phase 5: Documentation (Ready to Start)

### –§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:

1. **README.md**
   - –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é "Multi-Store Support"
   - –°–∫—Ä–∏–Ω—à–æ—Ç—ã UI
   - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

2. **TESTING_INSTRUCTIONS.md**
   - –û–±–Ω–æ–≤–∏—Ç—å test cases –¥–ª—è multi-store
   - –î–æ–±–∞–≤–∏—Ç—å 8 –Ω–æ–≤—ã—Ö TC-MS-* —Ç–µ—Å—Ç–æ–≤

---

## ‚ö†Ô∏è Known Limitations

### 1. StoreManager –ø–æ–∫–∞ –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
- `complaints-page.js` –Ω–∞–ø—Ä—è–º—É—é –¥–µ–ª–∞–µ—Ç fetch
- `StoreManager` —Å–æ–∑–¥–∞–Ω, –Ω–æ –ù–ï –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω

**–ü–æ—á–µ–º—É:**
- `complaints-page.js` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ES6 modules (–Ω–µ—Ç import/export)
- –§–∞–π–ª –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–∞–∫ –æ–±—ã—á–Ω—ã–π `<script src="...">`
- –ù—É–∂–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è modules

**–†–µ—à–µ–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
1. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `complaints-page.js` –≤ module
2. –û–±–Ω–æ–≤–∏—Ç—å HTML: `<script type="module" src="..."`
3. –ó–∞–º–µ–Ω–∏—Ç—å –ø—Ä—è–º–æ–π fetch –Ω–∞ `storeManager.loadStores()`

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** Low (—Ç–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ StoreManager)

---

### 2. HTTP 503 Error (–∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å–µ—Å—Å–∏–∏)

**–°—Ç–∞—Ç—É—Å:** –í–æ–∑–º–æ–∂–Ω–æ —É–∂–µ —Ä–µ—à–µ–Ω –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è `manifest.json` permission

**–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –æ—Å—Ç–∞–ª–∞—Å—å:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ backend
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å backend (http://158.160.217.236)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º Backend Token

---

## ‚úÖ Success Criteria

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ–π, –∫–æ–≥–¥–∞:

- ‚úÖ Phase 1 (UI) ‚Äî COMPLETED
- ‚úÖ Phase 2 (Settings) ‚Äî COMPLETED
- ‚úÖ Phase 3 (StoreManager) ‚Äî COMPLETED
- ‚è≥ Phase 4 (Testing) ‚Äî **8/8 —Ç–µ—Å—Ç–æ–≤ passed**
- ‚è≥ Phase 5 (Docs) ‚Äî **README –∏ TESTING_INSTRUCTIONS –æ–±–Ω–æ–≤–ª–µ–Ω—ã**

---

## üöÄ Next Steps

### Immediate:

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Phase 4):**
   - –û—Ç–∫—Ä—ã—Ç—å complaints-page.html
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –º–∞–≥–∞–∑–∏–Ω–æ–≤ –∏–∑ backend
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ 8 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ Backend Token:**
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ Backend Token –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ options.html
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ token –≤–∞–ª–∏–¥–µ–Ω (–¥–ª–∏–Ω–∞ ‚â•32 —Å–∏–º–≤–æ–ª–∞)

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ Endpoint:**
   ```bash
   curl -X GET "http://158.160.217.236/api/extension/stores" \
     -H "Authorization: Bearer YOUR_TOKEN"
   ```
   - **Expected:** HTTP 200 + —Å–ø–∏—Å–æ–∫ –º–∞–≥–∞–∑–∏–Ω–æ–≤

### Optional (Future Enhancements):

1. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è StoreManager:**
   - –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å complaints-page.js –≤ ES6 module
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `storeManager.loadStores()` –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ fetch

2. **UI Improvements:**
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–µ—à —Å—Ç–∞—Ç—É—Å –≤ UI ("–∑–∞–≥—Ä—É–∂–µ–Ω–æ –∏–∑ –∫–µ—à–∞")
   - –ò–∫–æ–Ω–∫–∞ —Ä—è–¥–æ–º —Å –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–º–∏ –º–∞–≥–∞–∑–∏–Ω–∞–º–∏ (‚ö†Ô∏è)
   - Tooltip —Å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç—è–º–∏ –æ –º–∞–≥–∞–∑–∏–Ω–µ

3. **Analytics:**
   - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—ã–±–æ—Ä –º–∞–≥–∞–∑–∏–Ω–æ–≤
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —á–∞—Å—Ç–æ—Ç–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π
   - –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Google Sheets

---

## üìû Support & Troubleshooting

### –ï—Å–ª–∏ dropdown –ø—É—Å—Ç:

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Backend Token:**
   - –û—Ç–∫—Ä—ã—Ç—å options.html
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å "Backend API Configuration"
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ token –Ω–∞—Å—Ç—Ä–æ–µ–Ω

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å console logs:**
   ```
   F12 ‚Üí Console ‚Üí —Ñ–∏–ª—å—Ç—Ä: "Complaints Page"
   ```
   - –ò—Å–∫–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å HTTP status code

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Network tab:**
   - F12 ‚Üí Network ‚Üí XHR
   - –ù–∞–π—Ç–∏ –∑–∞–ø—Ä–æ—Å –∫ `/api/extension/stores`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å status code –∏ response

### –ï—Å–ª–∏ –≤—ã–±–æ—Ä –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è:

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å chrome.storage:**
   ```javascript
   // –í DevTools Console:
   chrome.storage.local.get('currentStoreId', console.log)
   ```
   - **Expected:** `{ currentStoreId: "ss6Y8orHTX6vS7SgJl4k" }`

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å event listener:**
   - –í—ã–±—Ä–∞—Ç—å –º–∞–≥–∞–∑–∏–Ω
   - –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å console logs
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: "‚úÖ –í—ã–±—Ä–∞–Ω –º–∞–≥–∞–∑–∏–Ω: ..."

---

## üéâ Summary

**Phases 1-3 Successfully Implemented!**

- ‚úÖ UI –æ–±–Ω–æ–≤–ª–µ–Ω —Å dropdown + –∫–Ω–æ–ø–∫–æ–π –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ Settings service —Ä–∞—Å—à–∏—Ä–µ–Ω –º–µ—Ç–æ–¥–∞–º–∏ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞
- ‚úÖ StoreManager —Å–æ–∑–¥–∞–Ω —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ error handling
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞
- ‚è≥ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!

**Estimated Completion Time:**
- Phases 1-3: ~4 hours (‚úÖ DONE)
- Phase 4 (Testing): ~1 hour (‚è≥ NEXT)
- Phase 5 (Docs): ~30 min (‚è≥ NEXT)

**Total:** 5.5 hours (~7.5 hours planned, –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –±—ã—Å—Ç—Ä–µ–µ!)

---

**–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é! üöÄ**

**Next:** –û—Ç–∫—Ä–æ–π—Ç–µ complaints-page.html –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É multi-store —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞.
