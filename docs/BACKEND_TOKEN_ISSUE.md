# ‚ùå Backend API Token Issue - –¢—Ä–µ–±—É–µ—Ç—Å—è –ü–æ–º–æ—â—å

**–î–∞—Ç–∞:** 2026-01-29
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî• –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô
**–°—Ç–∞—Ç—É—Å:** üö´ –ë–õ–û–ö–ò–†–£–ï–¢ –†–ê–ó–†–ê–ë–û–¢–ö–£

---

## üìã –ö—Ä–∞—Ç–∫–æ–µ –û–ø–∏—Å–∞–Ω–∏–µ –ü—Ä–æ–±–ª–µ–º—ã

–ü—Ä–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Multi-Store —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ, —á—Ç–æ **–≤—Å–µ —Ç–æ–∫–µ–Ω—ã –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã**.

Backend API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É **401 Unauthorized** —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º:
```json
{
  "error": "Unauthorized",
  "message": "Invalid or expired token"
}
```

---

## üîç –î–µ—Ç–∞–ª—å–Ω–∞—è –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### 1. Backend Server Status

‚úÖ **–°–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ:**

```bash
curl http://158.160.217.236/api/health
```

**Response:**
```json
{
  "status": "unhealthy",
  "version": "2.0.0",
  "environment": "production",
  "services": {
    "database": {
      "status": "healthy",
      "message": "Connected",
      "details": {
        "latency_ms": 6,
        "server_time": "2026-01-29T09:30:28.700Z"
      }
    },
    "rateLimiter": {
      "status": "healthy",
      "message": "Operational",
      "details": {
        "maxRequestsPerMinute": 100
      }
    }
  }
}
```

‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úÖ Rate Limiter —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úÖ –í–µ—Ä—Å–∏—è API: 2.0.0

---

### 2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¢–æ–∫–µ–Ω—ã

#### –¢–æ–∫–µ–Ω #1 (–∏–∑ BACKEND_API_READY.md)
```
d794d4408ef0955a693afaa913dd195ddd25f447e94d098c2f6e0155aa2b0038
```

**–¢–µ—Å—Ç:**
```bash
curl -H "Authorization: Bearer d794d4408ef0955a693afaa913dd195ddd25f447e94d098c2f6e0155aa2b0038" \
     http://158.160.217.236/api/extension/stores
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚ùå `{"error":"Unauthorized","message":"Invalid or expired token"}`

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**
- `BACKEND_API_READY.md` (—Å—Ç—Ä–æ–∫–∞ 34)
- `QUICK_START.md` (—Å—Ç—Ä–æ–∫–∞ 14)
- `MULTI_STORE_ENDPOINT.md` (—É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –∫–∞–∫ –ø—Ä–∏–º–µ—Ä)
- `TESTING_INSTRUCTIONS.md` (—Å—Ç—Ä–æ–∫–∞ 127)
- –í—Å–µ —Ñ–∞–π–ª—ã –≤ `/docs/`

---

#### –¢–æ–∫–µ–Ω #2 (Pilot Entry API)
```
wbrm_u1512gxsgp1nt1n31fmsj1d31o51jue
```

**–¢–µ—Å—Ç:**
```bash
curl -H "Authorization: Bearer wbrm_u1512gxsgp1nt1n31fmsj1d31o51jue" \
     http://158.160.217.236/api/extension/stores
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚ùå `{"error":"Unauthorized","message":"Invalid or expired token"}`

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–æ —Ç–æ–∫–µ–Ω –¥–ª—è —Å—Ç–∞—Ä–æ–≥–æ Pilot Entry API (`https://pilot-entry.ru/api`), –Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞–ª–∏ –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π.

---

### 3. Endpoint, –∫–æ—Ç–æ—Ä—ã–π –ø—ã—Ç–∞–µ–º—Å—è –≤—ã–∑–≤–∞—Ç—å

```
GET http://158.160.217.236/api/extension/stores
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –º–∞–≥–∞–∑–∏–Ω–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è Multi-Store dropdown

**–¢—Ä–µ–±—É–µ—Ç—Å—è:** Bearer Token –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization`

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
[
  {
    "id": "ss6Y8orHTX6vS7SgJl4k",
    "name": "20Grace –ò–ü –®–∏—Ä–∞–∑–¥–∞–Ω–æ–≤–∞ –ì. –ú.",
    "isActive": true
  }
]
```

---

## üéØ –ß—Ç–æ –ù–∞–º –ù—É–∂–Ω–æ –æ—Ç Backend –ö–æ–º–∞–Ω–¥—ã

### 1. –ê–∫—Ç—É–∞–ª—å–Ω—ã–π Backend Token

–ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ **–¥–µ–π—Å—Ç–≤—É—é—â–∏–π Bearer Token** –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å:
- `http://158.160.217.236/api/extension/stores`
- `http://158.160.217.236/api/stores/:storeId/complaints`
- `http://158.160.217.236/api/stores/:storeId/reviews/:reviewId/complaint/sent`

### 2. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–∫–µ–Ω–µ

- **–§–æ—Ä–º–∞—Ç:** –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –ª–∏ —Ç–æ–∫–µ–Ω —Å `wbrm_` –∏–ª–∏ —ç—Ç–æ hex-—Å—Ç—Ä–æ–∫–∞?
- **–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è:** –ï—Å—Ç—å –ª–∏ —É —Ç–æ–∫–µ–Ω–∞ expiration date?
- **–ü—Ä–∏–≤—è–∑–∫–∞:** –¢–æ–∫–µ–Ω –ø—Ä–∏–≤—è–∑–∞–Ω –∫ Store ID `ss6Y8orHTX6vS7SgJl4k`?

### 3. –ü—Ä–∏—á–∏–Ω–∞ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å—Ç–∞—Ä—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤

–î–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å–∏—Ç—É–∞—Ü–∏–∏:
- –¢–æ–∫–µ–Ω—ã –±—ã–ª–∏ –æ—Ç–æ–∑–≤–∞–Ω—ã?
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–∞ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è?
- –ò–∑–º–µ–Ω–∏–ª—Å—è —Ñ–æ—Ä–º–∞—Ç —Ç–æ–∫–µ–Ω–æ–≤ –≤ –≤–µ—Ä—Å–∏–∏ 2.0.0?

---

## üìä –ö–æ–Ω—Ç–µ–∫—Å—Ç –†–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –ß—Ç–æ –º—ã —Ä–µ–∞–ª–∏–∑—É–µ–º

**Multi-Store Integration** - –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –º–∞–≥–∞–∑–∏–Ω–∞–º–∏ —á–µ—Ä–µ–∑ dropdown –≤ UI —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è.

**–°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- ‚úÖ UI –≥–æ—Ç–æ–≤ (dropdown –≤ `complaints-page.html`)
- ‚úÖ –õ–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–∞–≥–∞–∑–∏–Ω–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- ‚úÖ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å TTL 5 –º–∏–Ω—É—Ç
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤
- üö´ **–ë–õ–û–ö–ò–†–£–ï–¢–°–Ø:** –ù–µ—Ç –≤–∞–ª–∏–¥–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–µ–∫—É—â–∏–π –∫–æ–¥ (complaints-page.js)

```javascript
// üîí –•–ê–†–î–ö–û–î Backend API –¥–ª—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–í–†–ï–ú–ï–ù–ù–û–ï –†–ï–®–ï–ù–ò–ï)
const BACKEND_ENDPOINT = 'http://158.160.217.236';
const BACKEND_TOKEN = 'd794d4408ef0955a693afaa913dd195ddd25f447e94d098c2f6e0155aa2b0038'; // ‚ùå –ù–ï –†–ê–ë–û–¢–ê–ï–¢

async function loadStores(forceRefresh = false) {
  const response = await fetch(`${BACKEND_ENDPOINT}/api/extension/stores`, {
    headers: {
      'Authorization': `Bearer ${BACKEND_TOKEN}`,
      'Content-Type': 'application/json'
    }
  });

  if (!response.ok) {
    // 401 Unauthorized - Invalid token
    throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π Backend Token');
  }

  return await response.json();
}
```

---

## üîß –í—Ä–µ–º–µ–Ω–Ω–æ–µ –†–µ—à–µ–Ω–∏–µ (–∫–æ—Ç–æ—Ä–æ–µ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–∫–∞)

–ü–æ–∫–∞ –∂–¥—ë–º –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω, –∑–∞—Ö–∞—Ä–¥–∫–æ–¥–∏–º Store ID –Ω–∞–ø—Ä—è–º—É—é:

```javascript
const STORE_ID = 'ss6Y8orHTX6vS7SgJl4k';
const STORE_NAME = '20Grace –ò–ü –®–∏—Ä–∞–∑–¥–∞–Ω–æ–≤–∞ –ì. –ú.';
```

–ù–æ —ç—Ç–æ **–Ω–µ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É**, —Ç–∞–∫ –∫–∞–∫:
1. –ù—É–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å complaints —á–µ—Ä–µ–∑ `/api/stores/:storeId/complaints` (—Ç–æ–∂–µ —Ç—Ä–µ–±—É–µ—Ç —Ç–æ–∫–µ–Ω)
2. –ù—É–∂–Ω–æ –æ—Ç–º–µ—á–∞—Ç—å –∂–∞–ª–æ–±—ã –∫–∞–∫ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ POST endpoint (—Ç–æ–∂–µ —Ç—Ä–µ–±—É–µ—Ç —Ç–æ–∫–µ–Ω)

**–ë–µ–∑ –≤–∞–ª–∏–¥–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ.**

---

## üìù –õ–æ–≥–∏ –û—à–∏–±–∫–∏ –∏–∑ –†–∞—Å—à–∏—Ä–µ–Ω–∏—è

```
[Complaints Page] üîÑ –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –º–∞–≥–∞–∑–∏–Ω–æ–≤...
[Complaints Page] üåê –ó–∞–ø—Ä–æ—Å –º–∞–≥–∞–∑–∏–Ω–æ–≤: http://158.160.217.236/api/extension/stores
[Complaints Page] üîë –¢–æ–∫–µ–Ω –¥–ª–∏–Ω–∞: 64
[Network] GET http://158.160.217.236/api/extension/stores
[Network] Status: 401 Unauthorized
[Network] Response: {"error":"Unauthorized","message":"Invalid or expired token"}
[Complaints Page] üì° –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞: 401 Unauthorized
[Complaints Page] ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–∞–≥–∞–∑–∏–Ω–æ–≤: Error: –ù–µ–≤–µ—Ä–Ω—ã–π Backend Token. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
```

---

## üìû –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –°–≤—è–∑–∏

**–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ:** Chrome Extension "R5 –ø–æ–¥–∞—á–∞ –∂–∞–ª–æ–±"
**–ü—Ä–æ–µ–∫—Ç Backend:** http://158.160.217.236
**GitHub Backend:** https://github.com/Klimov-IS/R5-Saas-v-2.0

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ –Ω–∞—à–µ–π —Å—Ç–æ—Ä–æ–Ω–µ:**
- `BACKEND_API_READY.md` - –æ—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ—Ç –≤–∞—Å
- `MULTI_STORE_ENDPOINT.md` - —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ endpoint
- `DEPLOYMENT_2026-01-28.md` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–µ–ø–ª–æ–µ

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –î–µ–π—Å—Ç–≤–∏–π –¥–ª—è Backend –ö–æ–º–∞–Ω–¥—ã

- [ ] –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–Ω—ã–π Bearer Token –¥–ª—è production (`http://158.160.217.236`)
- [ ] –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å, —á—Ç–æ Store ID `ss6Y8orHTX6vS7SgJl4k` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –±–∞–∑–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ endpoint `/api/extension/stores` —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–æ–≤—ã–º —Ç–æ–∫–µ–Ω–æ–º
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º (–∏–ª–∏ —Å–æ–æ–±—â–∏—Ç—å, –∫–∞–∫ –µ–≥–æ –ø–æ–ª—É—á–∏—Ç—å)
- [ ] (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –û–±—ä—è—Å–Ω–∏—Ç—å, –ø–æ—á–µ–º—É —Å—Ç–∞—Ä—ã–µ —Ç–æ–∫–µ–Ω—ã –ø–µ—Ä–µ—Å—Ç–∞–ª–∏ —Ä–∞–±–æ—Ç–∞—Ç—å

---

## ‚è±Ô∏è –°—Ä–æ—á–Ω–æ—Å—Ç—å

**–ë–ª–æ–∫–∏—Ä—É–µ—Ç:**
- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ Multi-Store –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
- –î–µ–ø–ª–æ–π –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

**–û–∂–∏–¥–∞–µ–º—ã–π timeline:**
- –ë–µ–∑ —Ç–æ–∫–µ–Ω–∞: —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
- –° —Ç–æ–∫–µ–Ω–æ–º: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –∑–∞ 1-2 —á–∞—Å–∞

---

## üôè –ó–∞–ø—Ä–æ—Å

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ **–∞–∫—Ç—É–∞–ª—å–Ω—ã–π Bearer Token** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Backend API –Ω–∞ `http://158.160.217.236`.

–ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –Ω—É–∂–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫–∏–º-—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º –∏–ª–∏ –µ—Å—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤ - –ø–æ–¥—Å–∫–∞–∂–∏—Ç–µ, –∫–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å.

**–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–º–æ—â—å!** üöÄ

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2026-01-29
**–ê–≤—Ç–æ—Ä:** Extension Development Team
**–ö–æ–Ω—Ç–∞–∫—Ç:** (–≤–∞—à –∫–æ–Ω—Ç–∞–∫—Ç)
