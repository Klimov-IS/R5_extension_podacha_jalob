<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WB - –ü–æ–¥–∞—á–∞ –∂–∞–ª–æ–±</title>
    <link rel="stylesheet" href="styles.css" />
    <style>
      body {
        width: 100%;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        min-height: 100vh;
      }
      .complaints-page {
        background: #fff;
        border-radius: 8px;
        padding: 24px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      }
      .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 24px;
        padding-bottom: 16px;
        border-bottom: 2px solid #e5e7eb;
      }
      .page-header h1 {
        margin: 0;
        font-size: 24px;
        color: #111;
      }
      .close-btn {
        background: #ef4444;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
      }
      .close-btn:hover {
        background: #dc2626;
      }
      .status-indicator {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background: #f3f4f6;
        border-radius: 4px;
        font-size: 14px;
        font-weight: 500;
      }
      .status-indicator.ready {
        background: #dcfce7;
        color: #166534;
      }
      .status-indicator.processing {
        background: #fef3c7;
        color: #92400e;
      }
      .url-info {
        background: #f0f9ff;
        border: 1px solid #bae6fd;
        border-radius: 6px;
        padding: 12px;
        margin: 16px 0;
        font-size: 13px;
        color: #0c4a6e;
      }
      .url-info strong {
        display: block;
        margin-bottom: 4px;
      }
      .url-info code {
        background: #fff;
        padding: 2px 6px;
        border-radius: 3px;
        font-size: 12px;
      }
    </style>
  </head>
  <body>
    <div class="complaints-page">
      <div class="page-header">
        <h1>üìù –ü–æ–¥–∞—á–∞ –∂–∞–ª–æ–± –Ω–∞ –æ—Ç–∑—ã–≤—ã</h1>
        <button id="btn-close-page" class="close-btn">‚úï –ó–∞–∫—Ä—ã—Ç—å</button>
      </div>

      <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è -->
      <div class="url-info">
        <strong>üìå –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</strong>
        1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ—Ç–∑—ã–≤–æ–≤ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ Wildberries<br />
        2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –Ω–∏–∂–µ –∏ –Ω–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É"<br />
        3. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∞—Å—Ç –∂–∞–ª–æ–±—ã –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –æ—Ç–∑—ã–≤—ã<br />
        <br />
        <strong>–§–æ—Ä–º–∞—Ç URL:</strong> <code>https://seller.wildberries.ru/product-card/good-feedbacks/list</code>
      </div>

      <!-- –§–æ—Ä–º–∞ -->
      <div class="form-group">
        <label for="store-select">–í—ã–±–µ—Ä–∏—Ç–µ –º–∞–≥–∞–∑–∏–Ω:</label>
        <div style="display: flex; align-items: center; gap: 10px;">
          <select id="store-select" style="flex: 1;">
            <option value="">–ó–∞–≥—Ä—É–∑–∫–∞ –º–∞–≥–∞–∑–∏–Ω–æ–≤...</option>
          </select>
          <button type="button" id="refresh-stores-btn" class="secondary-btn" style="padding: 8px 16px;">
            üîÑ –û–±–Ω–æ–≤–∏—Ç—å
          </button>
        </div>
        <small style="display: block; color: #666; font-size: 12px; margin-top: 8px;">
          üí° –í—ã–±–µ—Ä–∏—Ç–µ –º–∞–≥–∞–∑–∏–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã. –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å–µ—Ä—ã–º.
        </small>
        <div id="store-load-error" style="color: #ef4444; font-size: 12px; margin-top: 5px; display: none;"></div>
      </div>

      <div class="form-group">
        <label>–§–∏–ª—å—Ç—Ä –ø–æ –∑–≤—ë–∑–¥–∞–º:</label>
        <div class="stars">
          <label><input type="checkbox" class="complaint-star" value="1" checked /> 1 ‚≠ê</label>
          <label><input type="checkbox" class="complaint-star" value="2" checked /> 2 ‚≠ê‚≠ê</label>
          <label><input type="checkbox" class="complaint-star" value="3" /> 3 ‚≠ê‚≠ê‚≠ê</label>
          <label><input type="checkbox" class="complaint-star" value="4" /> 4 ‚≠ê‚≠ê‚≠ê‚≠ê</label>
          <label><input type="checkbox" class="complaint-star" value="5" /> 5 ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</label>
        </div>
      </div>

      <div class="form-group">
        <label for="complaint-articles">–ê—Ä—Ç–∏–∫—É–ª—ã —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</label>
        <textarea
          id="complaint-articles"
          placeholder="–í–≤–µ–¥–∏—Ç–µ –∞—Ä—Ç–∏–∫—É–ª—ã (–∫–∞–∂–¥—ã–π —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ –∏–ª–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):&#10;12345678&#10;87654321&#10;11223344"
          rows="5"
        ></textarea>
        <small style="color: #666; font-size: 12px;">
          <strong>–ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã:</strong> –ë—É–¥—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –∂–∞–ª–æ–±—ã –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –∞—Ä—Ç–∏–∫—É–ª—ã<br>
          <strong>–ï—Å–ª–∏ –ø—É—Å—Ç–æ:</strong> –ë—É–¥—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –í–°–ï –∂–∞–ª–æ–±—ã –∏–∑ API
        </small>
      </div>

      <button id="btn-start-complaints" class="submit-btn">
        üöÄ –ù–∞—á–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∂–∞–ª–æ–±
      </button>

      <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ API -->
      <div id="api-stats-preview" class="hidden" style="margin-top: 20px; padding: 16px; background: #f0f9ff; border: 2px solid #3b82f6; border-radius: 8px;">
        <h4 style="margin: 0 0 12px 0; color: #1e40af; font-size: 16px;">üìä –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ API</h4>
        <div id="api-stats-content" style="font-size: 14px; line-height: 1.8;"></div>

        <div class="buttons" style="margin-top: 16px;">
          <button id="btn-confirm-start" class="submit-btn">‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∏ –Ω–∞—á–∞—Ç—å</button>
          <button id="btn-cancel-preview" class="secondary-btn">‚úï –û—Ç–º–µ–Ω–∞</button>
        </div>
      </div>

      <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ -->
      <div id="complaints-progress" class="hidden">
        <h4 id="progress-title">‚è≥ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∂–∞–ª–æ–±...</h4>
        <div class="progress-info">
          <p style="font-size: 12px; color: #6b7280; margin-bottom: 8px;">
            ‚è∞ –ù–∞—á–∞–ª–æ: <span id="c-progress-start-time">-</span>
          </p>

          <!-- –í–°–ï–ì–û –ó–ê –°–ï–°–°–ò–Æ -->
          <p style="font-weight: 600; font-size: 15px; color: #1e40af; margin-bottom: 12px; padding: 8px; background: #eff6ff; border-radius: 4px;">
            üìä –í–°–ï–ì–û:
            <span id="c-total-processed">0</span> –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ |
            <span id="c-total-sent">0</span> –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ |
            <span id="c-total-skipped">0</span> –ø—Ä–æ–ø—É—â–µ–Ω–æ |
            <span id="c-total-errors">0</span> –æ—à–∏–±–æ–∫
          </p>

          <!-- –ë–ê–¢–ß–ò -->
          <details open style="margin-bottom: 12px; padding: 8px; background: #f9fafb; border-radius: 4px;">
            <summary style="cursor: pointer; font-weight: 600; color: #4b5563; user-select: none;">
              üì¶ –ü–∞–∫–µ—Ç—ã (<span id="batches-count">0</span>)
            </summary>
            <div id="batches-list" style="margin-top: 8px; font-size: 13px; line-height: 1.8;">
              <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –±–∞—Ç—á–∏ -->
            </div>
          </details>
        </div>
        <div class="progress-bar">
          <div id="c-progress-fill" class="progress-fill"></div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å –ª–æ–≥–æ–≤ -->
        <div class="logs-panel">
          <div class="logs-header">
            <strong>üìù –õ–æ–≥–∏:</strong>
            <button id="btn-clear-logs" class="tiny-btn">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
          </div>
          <div id="logs-container" class="logs-content"></div>
        </div>

        <div class="buttons">
          <button id="btn-stop-complaints" class="secondary-btn">‚èπ –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
          <button id="btn-download-logs" class="secondary-btn">üíæ –°–∫–∞—á–∞—Ç—å –ª–æ–≥–∏</button>
          <button id="btn-download-api-report" class="secondary-btn">üìä –°–∫–∞—á–∞—Ç—å –æ—Ç—á–µ—Ç API</button>
        </div>
      </div>

      <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ -->
      <div id="complaints-results" class="hidden">
        <h4>‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h4>
        <div class="results-stats">
          <p>–í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: <strong id="c-result-processed">0</strong></p>
          <p>–ñ–∞–ª–æ–± –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: <strong id="c-result-sent">0</strong></p>
          <p>–ü—Ä–æ–ø—É—â–µ–Ω–æ: <strong id="c-result-skipped">0</strong></p>
          <p>–û—à–∏–±–æ–∫: <strong id="c-result-errors">0</strong></p>

          <hr style="margin: 16px 0; border: none; border-top: 1px solid #e5e7eb;" />

          <p>–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: <strong id="c-result-duration">-</strong></p>
          <p style="font-size: 12px; color: #666;">
            –ù–∞—á–∞–ª–æ: <span id="c-result-start-time">-</span><br />
            –û–∫–æ–Ω—á–∞–Ω–∏–µ: <span id="c-result-end-time">-</span>
          </p>

          <hr style="margin: 16px 0; border: none; border-top: 1px solid #e5e7eb;" />

          <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∞—Ä—Ç–∏–∫—É–ª–∞–º -->
          <details open style="margin-top: 16px; padding: 12px; background: #eff6ff; border-radius: 4px; border: 1px solid #bfdbfe;">
            <summary style="cursor: pointer; font-weight: 600; user-select: none; color: #1e40af;">
              üì¶ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∞—Ä—Ç–∏–∫—É–ª–∞–º
            </summary>
            <div id="c-article-stats" style="margin-top: 12px; font-size: 14px; line-height: 2;"></div>
          </details>

          <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É -->
          <details style="margin-top: 16px; padding: 12px; background: #f9fafb; border-radius: 4px;">
            <summary style="cursor: pointer; font-weight: 600; user-select: none;">
              ‚≠ê –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É
            </summary>
            <div id="c-rating-stats" style="margin-top: 12px; font-size: 13px; line-height: 1.8;"></div>
          </details>
        </div>
        <div class="buttons">
          <button id="btn-download-results" class="submit-btn">üíæ –°–∫–∞—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
          <button id="btn-download-logs-final" class="secondary-btn">üìù –°–∫–∞—á–∞—Ç—å –ª–æ–≥–∏</button>
          <button id="btn-new-complaints" class="secondary-btn">üîÑ –ù–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞</button>
        </div>
      </div>
    </div>

    <script type="module" src="./src/complaints-page.js"></script>
  </body>
</html>
